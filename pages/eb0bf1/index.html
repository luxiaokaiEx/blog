<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | 卢晓凯博客</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/blog/img/favicon.ico">
    <meta name="description" content="让梦想在指尖上飞舞，让精彩在低调中绽放">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/blog/assets/css/0.styles.7758e167.css" as="style"><link rel="preload" href="/blog/assets/js/app.b5a3e498.js" as="script"><link rel="preload" href="/blog/assets/js/2.54247e65.js" as="script"><link rel="preload" href="/blog/assets/js/82.8aea023f.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.90642ad6.js"><link rel="prefetch" href="/blog/assets/js/100.a4c7bfbc.js"><link rel="prefetch" href="/blog/assets/js/101.33572c4e.js"><link rel="prefetch" href="/blog/assets/js/102.c0f02151.js"><link rel="prefetch" href="/blog/assets/js/103.6c9fb4d0.js"><link rel="prefetch" href="/blog/assets/js/104.2a03f19e.js"><link rel="prefetch" href="/blog/assets/js/105.d9575ac8.js"><link rel="prefetch" href="/blog/assets/js/106.6a467f4a.js"><link rel="prefetch" href="/blog/assets/js/107.9c192821.js"><link rel="prefetch" href="/blog/assets/js/108.c6209e7d.js"><link rel="prefetch" href="/blog/assets/js/109.3c8e69e1.js"><link rel="prefetch" href="/blog/assets/js/11.7f455c7a.js"><link rel="prefetch" href="/blog/assets/js/110.8f794c20.js"><link rel="prefetch" href="/blog/assets/js/111.c116edcd.js"><link rel="prefetch" href="/blog/assets/js/112.ada22db5.js"><link rel="prefetch" href="/blog/assets/js/113.0ba4a4c2.js"><link rel="prefetch" href="/blog/assets/js/114.b4cff4d1.js"><link rel="prefetch" href="/blog/assets/js/115.cc34750c.js"><link rel="prefetch" href="/blog/assets/js/116.4e4722c2.js"><link rel="prefetch" href="/blog/assets/js/117.5f457999.js"><link rel="prefetch" href="/blog/assets/js/118.946ac8de.js"><link rel="prefetch" href="/blog/assets/js/119.f3cb5b72.js"><link rel="prefetch" href="/blog/assets/js/12.0175221e.js"><link rel="prefetch" href="/blog/assets/js/120.15692e7a.js"><link rel="prefetch" href="/blog/assets/js/121.434b6841.js"><link rel="prefetch" href="/blog/assets/js/122.0ae161c6.js"><link rel="prefetch" href="/blog/assets/js/123.66a87129.js"><link rel="prefetch" href="/blog/assets/js/124.137806b0.js"><link rel="prefetch" href="/blog/assets/js/125.9ea42297.js"><link rel="prefetch" href="/blog/assets/js/126.61e2cf2f.js"><link rel="prefetch" href="/blog/assets/js/127.6b352d76.js"><link rel="prefetch" href="/blog/assets/js/128.16366692.js"><link rel="prefetch" href="/blog/assets/js/129.3b3a7a35.js"><link rel="prefetch" href="/blog/assets/js/13.44bc1050.js"><link rel="prefetch" href="/blog/assets/js/130.37cbad2f.js"><link rel="prefetch" href="/blog/assets/js/131.a336760d.js"><link rel="prefetch" href="/blog/assets/js/132.fbef77e9.js"><link rel="prefetch" href="/blog/assets/js/133.83b0592a.js"><link rel="prefetch" href="/blog/assets/js/134.6546bf0b.js"><link rel="prefetch" href="/blog/assets/js/135.66788a21.js"><link rel="prefetch" href="/blog/assets/js/136.eec97c0b.js"><link rel="prefetch" href="/blog/assets/js/137.ab189a6a.js"><link rel="prefetch" href="/blog/assets/js/138.d317a19a.js"><link rel="prefetch" href="/blog/assets/js/139.76682d29.js"><link rel="prefetch" href="/blog/assets/js/14.0a7de9c9.js"><link rel="prefetch" href="/blog/assets/js/140.3270dcfc.js"><link rel="prefetch" href="/blog/assets/js/141.dacee2bb.js"><link rel="prefetch" href="/blog/assets/js/142.9c9104b3.js"><link rel="prefetch" href="/blog/assets/js/143.2a1493f0.js"><link rel="prefetch" href="/blog/assets/js/144.c847289f.js"><link rel="prefetch" href="/blog/assets/js/145.4f68d102.js"><link rel="prefetch" href="/blog/assets/js/146.aaa2a6b4.js"><link rel="prefetch" href="/blog/assets/js/147.04bcaaef.js"><link rel="prefetch" href="/blog/assets/js/148.dc72e45a.js"><link rel="prefetch" href="/blog/assets/js/149.47d1f466.js"><link rel="prefetch" href="/blog/assets/js/15.9ff31133.js"><link rel="prefetch" href="/blog/assets/js/150.818175f9.js"><link rel="prefetch" href="/blog/assets/js/151.ed36940c.js"><link rel="prefetch" href="/blog/assets/js/152.34f9c271.js"><link rel="prefetch" href="/blog/assets/js/153.05c6e599.js"><link rel="prefetch" href="/blog/assets/js/154.9a576635.js"><link rel="prefetch" href="/blog/assets/js/155.ccf85f09.js"><link rel="prefetch" href="/blog/assets/js/156.c40c89e1.js"><link rel="prefetch" href="/blog/assets/js/157.ef69e50d.js"><link rel="prefetch" href="/blog/assets/js/158.df24f1df.js"><link rel="prefetch" href="/blog/assets/js/159.8f75e4b8.js"><link rel="prefetch" href="/blog/assets/js/16.447bf2f6.js"><link rel="prefetch" href="/blog/assets/js/160.7652a41d.js"><link rel="prefetch" href="/blog/assets/js/161.9719a9f6.js"><link rel="prefetch" href="/blog/assets/js/162.21255d53.js"><link rel="prefetch" href="/blog/assets/js/163.e3771d0d.js"><link rel="prefetch" href="/blog/assets/js/164.242dc550.js"><link rel="prefetch" href="/blog/assets/js/165.99ac64bf.js"><link rel="prefetch" href="/blog/assets/js/166.5c7aedb0.js"><link rel="prefetch" href="/blog/assets/js/167.fafdbe81.js"><link rel="prefetch" href="/blog/assets/js/168.6b82118f.js"><link rel="prefetch" href="/blog/assets/js/169.2eb2339b.js"><link rel="prefetch" href="/blog/assets/js/17.ed1d707d.js"><link rel="prefetch" href="/blog/assets/js/170.05ababed.js"><link rel="prefetch" href="/blog/assets/js/171.ddb298d0.js"><link rel="prefetch" href="/blog/assets/js/172.3ba7ee86.js"><link rel="prefetch" href="/blog/assets/js/173.a119f0a7.js"><link rel="prefetch" href="/blog/assets/js/174.0f108c2b.js"><link rel="prefetch" href="/blog/assets/js/175.192556e2.js"><link rel="prefetch" href="/blog/assets/js/176.fb5dcb8c.js"><link rel="prefetch" href="/blog/assets/js/177.68631e88.js"><link rel="prefetch" href="/blog/assets/js/178.c7bcd2d8.js"><link rel="prefetch" href="/blog/assets/js/179.1bb7c0d4.js"><link rel="prefetch" href="/blog/assets/js/18.8b023b80.js"><link rel="prefetch" href="/blog/assets/js/180.fcb03dc0.js"><link rel="prefetch" href="/blog/assets/js/181.0b2f3ae3.js"><link rel="prefetch" href="/blog/assets/js/182.55e15eb2.js"><link rel="prefetch" href="/blog/assets/js/183.f9e39f1f.js"><link rel="prefetch" href="/blog/assets/js/184.17ff8e00.js"><link rel="prefetch" href="/blog/assets/js/185.1f1abe34.js"><link rel="prefetch" href="/blog/assets/js/186.9855d491.js"><link rel="prefetch" href="/blog/assets/js/187.4eb56f9c.js"><link rel="prefetch" href="/blog/assets/js/188.4144a52d.js"><link rel="prefetch" href="/blog/assets/js/189.8c87e688.js"><link rel="prefetch" href="/blog/assets/js/19.ba0eb3e4.js"><link rel="prefetch" href="/blog/assets/js/190.c8ccd784.js"><link rel="prefetch" href="/blog/assets/js/191.d498e36c.js"><link rel="prefetch" href="/blog/assets/js/192.3fd6c202.js"><link rel="prefetch" href="/blog/assets/js/193.abb22464.js"><link rel="prefetch" href="/blog/assets/js/194.7c657be3.js"><link rel="prefetch" href="/blog/assets/js/195.def3cd71.js"><link rel="prefetch" href="/blog/assets/js/196.fa18a652.js"><link rel="prefetch" href="/blog/assets/js/197.7a0025e3.js"><link rel="prefetch" href="/blog/assets/js/198.d7c62a7e.js"><link rel="prefetch" href="/blog/assets/js/199.5b1f084b.js"><link rel="prefetch" href="/blog/assets/js/20.99378379.js"><link rel="prefetch" href="/blog/assets/js/200.6e50c338.js"><link rel="prefetch" href="/blog/assets/js/201.117b6b83.js"><link rel="prefetch" href="/blog/assets/js/202.57e49225.js"><link rel="prefetch" href="/blog/assets/js/203.e040335d.js"><link rel="prefetch" href="/blog/assets/js/204.0c7e36e8.js"><link rel="prefetch" href="/blog/assets/js/205.24f4e805.js"><link rel="prefetch" href="/blog/assets/js/206.821480a2.js"><link rel="prefetch" href="/blog/assets/js/207.d6227be6.js"><link rel="prefetch" href="/blog/assets/js/208.b7ac4d01.js"><link rel="prefetch" href="/blog/assets/js/209.2730e470.js"><link rel="prefetch" href="/blog/assets/js/21.3ed664d2.js"><link rel="prefetch" href="/blog/assets/js/210.5d11c882.js"><link rel="prefetch" href="/blog/assets/js/211.ed0e2466.js"><link rel="prefetch" href="/blog/assets/js/212.904f0bed.js"><link rel="prefetch" href="/blog/assets/js/213.f770997a.js"><link rel="prefetch" href="/blog/assets/js/214.9262ad66.js"><link rel="prefetch" href="/blog/assets/js/215.270b4d0c.js"><link rel="prefetch" href="/blog/assets/js/216.3eb3e151.js"><link rel="prefetch" href="/blog/assets/js/217.8d9dffe3.js"><link rel="prefetch" href="/blog/assets/js/218.89e0b39b.js"><link rel="prefetch" href="/blog/assets/js/219.9aa621cb.js"><link rel="prefetch" href="/blog/assets/js/22.ffdc82f3.js"><link rel="prefetch" href="/blog/assets/js/220.81f7f3fe.js"><link rel="prefetch" href="/blog/assets/js/221.53d35a7b.js"><link rel="prefetch" href="/blog/assets/js/222.ed3c1f57.js"><link rel="prefetch" href="/blog/assets/js/223.01cf6ba2.js"><link rel="prefetch" href="/blog/assets/js/224.a32b9911.js"><link rel="prefetch" href="/blog/assets/js/225.2b692504.js"><link rel="prefetch" href="/blog/assets/js/226.05528809.js"><link rel="prefetch" href="/blog/assets/js/227.78c67da4.js"><link rel="prefetch" href="/blog/assets/js/228.fa3f7d59.js"><link rel="prefetch" href="/blog/assets/js/229.11d0c52c.js"><link rel="prefetch" href="/blog/assets/js/23.7aaad5b5.js"><link rel="prefetch" href="/blog/assets/js/230.99b3c95d.js"><link rel="prefetch" href="/blog/assets/js/231.4bb6c12b.js"><link rel="prefetch" href="/blog/assets/js/232.a4ceea35.js"><link rel="prefetch" href="/blog/assets/js/233.14382374.js"><link rel="prefetch" href="/blog/assets/js/234.848a0551.js"><link rel="prefetch" href="/blog/assets/js/235.8ef5b0cd.js"><link rel="prefetch" href="/blog/assets/js/236.3d16aa5b.js"><link rel="prefetch" href="/blog/assets/js/237.f3b8152d.js"><link rel="prefetch" href="/blog/assets/js/238.fba0cedf.js"><link rel="prefetch" href="/blog/assets/js/239.fbe3523d.js"><link rel="prefetch" href="/blog/assets/js/24.d7dca157.js"><link rel="prefetch" href="/blog/assets/js/240.4fb4d431.js"><link rel="prefetch" href="/blog/assets/js/241.8a58e661.js"><link rel="prefetch" href="/blog/assets/js/242.820d8bbc.js"><link rel="prefetch" href="/blog/assets/js/243.35442a40.js"><link rel="prefetch" href="/blog/assets/js/244.9d8d5d85.js"><link rel="prefetch" href="/blog/assets/js/245.f1f96c18.js"><link rel="prefetch" href="/blog/assets/js/246.cb5b5543.js"><link rel="prefetch" href="/blog/assets/js/25.eeaff119.js"><link rel="prefetch" href="/blog/assets/js/26.efa9df2a.js"><link rel="prefetch" href="/blog/assets/js/27.41e4dba0.js"><link rel="prefetch" href="/blog/assets/js/28.7f2fee4f.js"><link rel="prefetch" href="/blog/assets/js/29.c31e0387.js"><link rel="prefetch" href="/blog/assets/js/3.92994e45.js"><link rel="prefetch" href="/blog/assets/js/30.dd4a2764.js"><link rel="prefetch" href="/blog/assets/js/31.a2459775.js"><link rel="prefetch" href="/blog/assets/js/32.6f278954.js"><link rel="prefetch" href="/blog/assets/js/33.f2a21ab3.js"><link rel="prefetch" href="/blog/assets/js/34.01915535.js"><link rel="prefetch" href="/blog/assets/js/35.2ac00d83.js"><link rel="prefetch" href="/blog/assets/js/36.5563ea70.js"><link rel="prefetch" href="/blog/assets/js/37.189d2015.js"><link rel="prefetch" href="/blog/assets/js/38.fbb768e0.js"><link rel="prefetch" href="/blog/assets/js/39.02947186.js"><link rel="prefetch" href="/blog/assets/js/4.1a915179.js"><link rel="prefetch" href="/blog/assets/js/40.9c928c87.js"><link rel="prefetch" href="/blog/assets/js/41.321b7160.js"><link rel="prefetch" href="/blog/assets/js/42.0841f991.js"><link rel="prefetch" href="/blog/assets/js/43.f9a6c44a.js"><link rel="prefetch" href="/blog/assets/js/44.86fa98ce.js"><link rel="prefetch" href="/blog/assets/js/45.fcffc65b.js"><link rel="prefetch" href="/blog/assets/js/46.8adc9063.js"><link rel="prefetch" href="/blog/assets/js/47.040cf904.js"><link rel="prefetch" href="/blog/assets/js/48.ed19895a.js"><link rel="prefetch" href="/blog/assets/js/49.5eb3e803.js"><link rel="prefetch" href="/blog/assets/js/5.835b5e7b.js"><link rel="prefetch" href="/blog/assets/js/50.5512527c.js"><link rel="prefetch" href="/blog/assets/js/51.7cf5187f.js"><link rel="prefetch" href="/blog/assets/js/52.6181b6da.js"><link rel="prefetch" href="/blog/assets/js/53.c9bd554e.js"><link rel="prefetch" href="/blog/assets/js/54.3af47ae6.js"><link rel="prefetch" href="/blog/assets/js/55.3fd4a8c5.js"><link rel="prefetch" href="/blog/assets/js/56.98fb2046.js"><link rel="prefetch" href="/blog/assets/js/57.fc16c4d1.js"><link rel="prefetch" href="/blog/assets/js/58.e17637ba.js"><link rel="prefetch" href="/blog/assets/js/59.d877df3c.js"><link rel="prefetch" href="/blog/assets/js/6.9147e28e.js"><link rel="prefetch" href="/blog/assets/js/60.0a6a7999.js"><link rel="prefetch" href="/blog/assets/js/61.4ae6380e.js"><link rel="prefetch" href="/blog/assets/js/62.37195586.js"><link rel="prefetch" href="/blog/assets/js/63.e78a861d.js"><link rel="prefetch" href="/blog/assets/js/64.cbae3378.js"><link rel="prefetch" href="/blog/assets/js/65.bab024bc.js"><link rel="prefetch" href="/blog/assets/js/66.3190c8aa.js"><link rel="prefetch" href="/blog/assets/js/67.945446b5.js"><link rel="prefetch" href="/blog/assets/js/68.9cf53668.js"><link rel="prefetch" href="/blog/assets/js/69.5b3664cd.js"><link rel="prefetch" href="/blog/assets/js/7.6537dd6b.js"><link rel="prefetch" href="/blog/assets/js/70.e9ffd19c.js"><link rel="prefetch" href="/blog/assets/js/71.28d8da0c.js"><link rel="prefetch" href="/blog/assets/js/72.2d5a623a.js"><link rel="prefetch" href="/blog/assets/js/73.7805f557.js"><link rel="prefetch" href="/blog/assets/js/74.6497ec84.js"><link rel="prefetch" href="/blog/assets/js/75.4fb067f9.js"><link rel="prefetch" href="/blog/assets/js/76.6ccd5a29.js"><link rel="prefetch" href="/blog/assets/js/77.eeaea387.js"><link rel="prefetch" href="/blog/assets/js/78.769b0e19.js"><link rel="prefetch" href="/blog/assets/js/79.605d03c9.js"><link rel="prefetch" href="/blog/assets/js/8.3d3f7b89.js"><link rel="prefetch" href="/blog/assets/js/80.1cd3c30f.js"><link rel="prefetch" href="/blog/assets/js/81.50138719.js"><link rel="prefetch" href="/blog/assets/js/83.14cb03b4.js"><link rel="prefetch" href="/blog/assets/js/84.a457ec68.js"><link rel="prefetch" href="/blog/assets/js/85.7829e892.js"><link rel="prefetch" href="/blog/assets/js/86.eca3d6be.js"><link rel="prefetch" href="/blog/assets/js/87.49e0348d.js"><link rel="prefetch" href="/blog/assets/js/88.c492a970.js"><link rel="prefetch" href="/blog/assets/js/89.989712ce.js"><link rel="prefetch" href="/blog/assets/js/9.75f10d87.js"><link rel="prefetch" href="/blog/assets/js/90.94442bae.js"><link rel="prefetch" href="/blog/assets/js/91.e6541063.js"><link rel="prefetch" href="/blog/assets/js/92.c4fead94.js"><link rel="prefetch" href="/blog/assets/js/93.23d48dd2.js"><link rel="prefetch" href="/blog/assets/js/94.e38fcb6b.js"><link rel="prefetch" href="/blog/assets/js/95.2045be00.js"><link rel="prefetch" href="/blog/assets/js/96.58968759.js"><link rel="prefetch" href="/blog/assets/js/97.82ecea38.js"><link rel="prefetch" href="/blog/assets/js/98.6fc6b44c.js"><link rel="prefetch" href="/blog/assets/js/99.2e09b81e.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.7758e167.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/img/logo.png" alt="卢晓凯博客" class="logo"> <span class="site-name can-hide">卢晓凯博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/blog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/blog/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/blog/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/blog/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/blog/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/blog/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/blog/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/blog/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/blog/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/blog/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/blog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/blog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/blog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/luxiaokaiEx/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fup.enterdesk.com%2Fedpic_source%2F9e%2F32%2F9a%2F9e329acc0c79523b0204f6ed7ea1e45e.jpg&amp;refer=http%3A%2F%2Fup.enterdesk.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1655723117&amp;t=c8a4823fe2c402ca288fbe5dbd7e4868"> <div class="blogger-info"><h3>XiaoKai Lu</h3> <span>java开发</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/blog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/blog/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/blog/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/blog/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/blog/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/blog/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/blog/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/blog/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/blog/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/blog/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/blog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/blog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/blog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/luxiaokaiEx/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/pages/eb0bf1/#docker-简介" class="sidebar-link">Docker 简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#docker优点" class="sidebar-link">Docker优点</a></li></ul></li><li><a href="/blog/pages/eb0bf1/#docker-架构" class="sidebar-link">Docker 架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#host-docker-宿主机" class="sidebar-link">Host(Docker 宿主机)</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#docker-daemon-docker-守护进程" class="sidebar-link">Docker daemon(Docker 守护进程)：</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#images-镜像" class="sidebar-link">Images(镜像)：</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#containers-容器" class="sidebar-link">Containers(容器)：</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#docker-client-docker-客户端" class="sidebar-link">Docker Client(Docker 客户端)</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#registry-仓库服务注册" class="sidebar-link">Registry(仓库服务注册)</a></li></ul></li><li><a href="/blog/pages/eb0bf1/#docker-安装" class="sidebar-link">Docker 安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#操作系统要求" class="sidebar-link">操作系统要求</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#一、准备" class="sidebar-link">一、准备</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#二、安装" class="sidebar-link">二、安装</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#三、配置镜像加速" class="sidebar-link">三、配置镜像加速</a></li></ul></li><li><a href="/blog/pages/eb0bf1/#docker常用操作" class="sidebar-link">Docker常用操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#镜像常用操作" class="sidebar-link">镜像常用操作</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#容器常用操作" class="sidebar-link">容器常用操作</a></li></ul></li><li><a href="/blog/pages/eb0bf1/#docker-安装各种镜像" class="sidebar-link">Docker 安装各种镜像</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#mysql" class="sidebar-link">Mysql</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#mongodb" class="sidebar-link">MongoDB</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#redis" class="sidebar-link">redis</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#oracle" class="sidebar-link">oracle</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#elasticsearch" class="sidebar-link">Elasticsearch</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#kibana" class="sidebar-link">kibana</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#rabbitmq" class="sidebar-link">rabbitmq</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#nginx" class="sidebar-link">nginx</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#sqlserver" class="sidebar-link">sqlServer</a></li></ul></li><li><a href="/blog/pages/eb0bf1/#docker-遇到的问题" class="sidebar-link">Docker 遇到的问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#tomcat问题" class="sidebar-link">Tomcat问题</a></li><li class="sidebar-sub-header level5"><a href="/blog/pages/eb0bf1/#具体场景" class="sidebar-link">具体场景：</a></li><li class="sidebar-sub-header level5"><a href="/blog/pages/eb0bf1/#出现问题的版本" class="sidebar-link">出现问题的版本：</a></li><li class="sidebar-sub-header level5"><a href="/blog/pages/eb0bf1/#解决方法" class="sidebar-link">解决方法：</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#mysql问题" class="sidebar-link">Mysql问题</a></li><li class="sidebar-sub-header level5"><a href="/blog/pages/eb0bf1/#具体场景-2" class="sidebar-link">具体场景</a></li><li class="sidebar-sub-header level5"><a href="/blog/pages/eb0bf1/#解决方法-2" class="sidebar-link">解决方法</a></li></ul></li><li><a href="/blog/pages/eb0bf1/#更新镜像" class="sidebar-link">更新镜像</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/pages/eb0bf1/#使用dockerfile构建镜像" class="sidebar-link">使用Dockerfile构建镜像</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#什么是dockerfile" class="sidebar-link">什么是Dockerfile？</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#dockerfile格式" class="sidebar-link">Dockerfile格式</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#使用dockerfile构建springboot应用镜像" class="sidebar-link">使用Dockerfile构建SpringBoot应用镜像</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#dockerfile常用指令" class="sidebar-link">Dockerfile常用指令</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#from" class="sidebar-link">FROM</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#maintainer-depreacted" class="sidebar-link">MAINTAINER(depreacted)</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#label" class="sidebar-link">LABEL</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#copy" class="sidebar-link">COPY</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#add" class="sidebar-link">ADD</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#workdir" class="sidebar-link">WORKDIR</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#volume" class="sidebar-link">VOLUME</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#expose" class="sidebar-link">EXPOSE</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#env" class="sidebar-link">ENV</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#arg" class="sidebar-link">ARG</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#run" class="sidebar-link">RUN</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#cmd" class="sidebar-link">CMD</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#entrypoint" class="sidebar-link">ENTRYPOINT</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/eb0bf1/#onbuild" class="sidebar-link">ONBUILD</a></li></ul></li><li><a href="/blog/pages/eb0bf1/#docker的四种网络模式" class="sidebar-link">Docker的四种网络模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#bridge" class="sidebar-link">Bridge</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#host" class="sidebar-link">Host</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#none" class="sidebar-link">None</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#container" class="sidebar-link">container</a></li></ul></li><li><a href="/blog/pages/eb0bf1/#自定义docker0桥的网络属性信息" class="sidebar-link">自定义docker0桥的网络属性信息</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/pages/eb0bf1/#简介-2" class="sidebar-link">简介</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/pages/eb0bf1/#安装" class="sidebar-link">安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#通过python-pip安装" class="sidebar-link">通过Python-pip安装</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#通过github链接下载安装" class="sidebar-link">通过GitHub链接下载安装</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#简单实例" class="sidebar-link">简单实例</a></li></ul></li><li><a href="/blog/pages/eb0bf1/#docker-compose模板文件常用指令" class="sidebar-link">Docker Compose模板文件常用指令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#image" class="sidebar-link">image</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#build" class="sidebar-link">build</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#command" class="sidebar-link">command</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#links" class="sidebar-link">links</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#external-links" class="sidebar-link">external_links</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#ports" class="sidebar-link">ports</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#expose-2" class="sidebar-link">expose</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#volumes" class="sidebar-link">volumes</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#volumes-from" class="sidebar-link">volumes_from</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#environment" class="sidebar-link">environment</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#env-file" class="sidebar-link">env_file</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#extends" class="sidebar-link">extends</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#net" class="sidebar-link">net</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#dns" class="sidebar-link">dns</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#dns-search" class="sidebar-link">dns_search</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/eb0bf1/#其它" class="sidebar-link">其它</a></li></ul></li><li><a href="/blog/pages/eb0bf1/#使用docker-compose编排springcloud微服务" class="sidebar-link">使用Docker Compose编排SpringCloud微服务</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1baff76c><div class="articleInfo" data-v-1baff76c><!----> <div class="info" data-v-1baff76c><div title="作者" class="author iconfont icon-touxiang" data-v-1baff76c><a href="https://github.com/luxiaokai" target="_blank" title="作者" class="beLink" data-v-1baff76c>luxiaokai</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>2022-05-24</a></div> <div title="分类" class="date iconfont icon-wenjian" data-v-1baff76c><a href="/blog/categories/?category=%E9%9A%8F%E7%AC%94" data-v-1baff76c>随笔 </a></div></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Docker<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="docker-1"><a href="#docker-1" class="header-anchor">#</a> Docker（1）</h1> <h2 id="docker-简介"><a href="#docker-简介" class="header-anchor">#</a> Docker 简介</h2> <h3 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h3> <p>开发和运维之间因为环境不同而导致的矛盾</p> <p>集群环境下每台机器部署相同的应用</p> <p>DevOps(Development and Operations)</p> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>Docker是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的Linux机器上，也可以实现虚拟化，容器是完全使用沙箱机制，相互之间不会有任何接口。</p> <p>Docker是世界领先的软件容器平台。开发人员利用 Docker 可以消除协作编码时“在我的机器上可正常工作”的问题。运维人员利用 Docker 可以在隔离容器中并行运行和管理应用，获得更好的计算密度。企业利用 Docker 可以构建敏捷的软件交付管道，以更快的速度、更高的安全性和可靠的信誉为 Linux 和 Windows Server 应用发布新功能。</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/365147/1587017617582-88b3ba8d-43a3-4b45-9f2b-9ff16b7da376.png" alt="1.png"></p> <h3 id="docker优点"><a href="#docker优点" class="header-anchor">#</a> Docker优点</h3> <p>简化程序：
Docker 让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的 Linux 机器上，便可以实现虚拟化。Docker改变了虚拟化的方式，使开发者可以直接将自己的成果放入Docker中进行管理。方便快捷已经是 Docker的最大优势，过去需要用数天乃至数周的任务，在Docker容器的处理下，只需要数秒就能完成。</p> <p>避免选择恐惧症：
如果你有选择恐惧症，还是资深患者。Docker 帮你打包你的纠结！比如 Docker 镜像；Docker 镜像中包含了运行环境和配置，所以 Docker 可以简化部署多种应用实例工作。比如 Web 应用、后台应用、数据库应用、大数据应用比如 Hadoop 集群、消息队列等等都可以打包成一个镜像部署。</p> <p>节省开支：
一方面，云计算时代到来，使开发者不必为了追求效果而配置高额的硬件，Docker 改变了高性能必然高价格的思维定势。Docker 与云的结合，让云空间得到更充分的利用。不仅解决了硬件管理的问题，也改变了虚拟化的方式。</p> <h2 id="docker-架构"><a href="#docker-架构" class="header-anchor">#</a> Docker 架构</h2> <p>Docker使用C/S架构，Client通过接口与Server进程通信实现容器的构建，运行和发布，如图：</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/365147/1587017629001-91afd66d-0b2b-4836-92f9-8614fcbc691b.png" alt="2.png"></p> <h3 id="host-docker-宿主机"><a href="#host-docker-宿主机" class="header-anchor">#</a> Host(Docker 宿主机)</h3> <p>安装了Docker程序，并运行了Docker daemon的主机。</p> <h4 id="docker-daemon-docker-守护进程"><a href="#docker-daemon-docker-守护进程" class="header-anchor">#</a> Docker daemon(Docker 守护进程)：</h4> <p>运行在宿主机上，Docker守护进程，用户通过Docker client(Docker命令)与Docker daemon交互。</p> <h4 id="images-镜像"><a href="#images-镜像" class="header-anchor">#</a> Images(镜像)：</h4> <p>将软件环境打包好的模板，用来创建容器的，一个镜像可以创建多个容器。</p> <p>镜像分层结构：</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/365147/1587017642482-36494fbb-d25f-426c-b76c-2a9b27c415f9.jpeg" alt="docker image.jpg"></p> <p>位于下层的镜像称为父镜像(Parent Image)，最底层的称为基础镜像(Base Image)。</p> <p>最上层为“可读写”层，其下的均为“只读”层。</p> <p>AUFS:</p> <ul><li><p>advanced multi-layered unification filesystem：高级多层统一文件系统</p></li> <li><p>用于为Linux文件系统实现“联合挂载”</p></li> <li><p>AUFS是之前的UnionFS的重新实现</p></li> <li><p>Docker最初使用AUFS作为容器文件系统层</p></li> <li><p>AUFS的竞争产品是overlayFS，从3.18开始被合并入Linux内核</p></li> <li><p>Docker的分层镜像，除了AUFS，Docker还支持btrfs，devicemapper和vfs等</p></li></ul> <h4 id="containers-容器"><a href="#containers-容器" class="header-anchor">#</a> Containers(容器)：</h4> <p>Docker的运行组件，启动一个镜像就是一个容器，容器与容器之间相互隔离，并且互不影响。</p> <h3 id="docker-client-docker-客户端"><a href="#docker-client-docker-客户端" class="header-anchor">#</a> Docker Client(Docker 客户端)</h3> <p>Docker命令行工具，用户是用Docker Client与Docker daemon进行通信并返回结果给用户。也可以使用其他工具通过<a href="https://docs.docker.com/develop/sdk/" target="_blank" rel="noopener noreferrer">Docker Api <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>与Docker daemon通信。</p> <h3 id="registry-仓库服务注册"><a href="#registry-仓库服务注册" class="header-anchor">#</a> Registry(仓库服务注册)</h3> <p>经常会和仓库(Repository)混为一谈，实际上Registry上可以有多个仓库，每个仓库可以看成是一个用户，一个用户的仓库放了多个镜像。仓库分为了公开仓库(Public Repository)和私有仓库(Private Repository)，最大的公开仓库是官方的<a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，国内也有如阿里云、时速云等，可以给国内用户提供稳定快速的服务。用户也可以在本地网络内创建一个私有仓库。当用户创建了自己的镜像之后就可以使用 push 命令将它上传到公有或者私有仓库，这样下次在另外一台机器上使用这个镜像时候，只需要从仓库上 pull 下来就可以了。</p> <h2 id="docker-安装"><a href="#docker-安装" class="header-anchor">#</a> Docker 安装</h2> <p>Docker 提供了两个版本：社区版 (CE) 和企业版 (EE)。</p> <h3 id="操作系统要求"><a href="#操作系统要求" class="header-anchor">#</a> 操作系统要求</h3> <p>以Centos7为例，且Docker 要求操作系统必须为64位，且centos内核版本为3.1及以上。</p> <p>查看系统内核版本信息：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>uname -r
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="一、准备"><a href="#一、准备" class="header-anchor">#</a> 一、准备</h3> <p>卸载旧版本：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum remove docker docker-common docker-selinux docker-engine
yum remove docker-ce
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>卸载后将保留<code>/var/lib/docker</code>的内容（镜像、容器、存储卷和网络等）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>rm -rf /var/lib/docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>1.安装依赖软件包</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum install -y yum-utils device-mapper-persistent-data lvm2
#安装前可查看device-mapper-persistent-data和lvm2是否已经安装
rpm -qa|grep device-mapper-persistent-data
rpm -qa|grep lvm2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>2.设置yum源</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>此处设置的yum源一般不使用，下载docker很慢
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

修改此文件，将其中的下载路径更换为国内比较快的路径
vim /etc/yum.repos.d/docker-ce.repo
:%s@https://download.docker.com/@https://mirrors.tuna.tsinghua.edu.cn/docker-ce/@
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>3.更新yum软件包索引</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum makecache fast
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="二、安装"><a href="#二、安装" class="header-anchor">#</a> 二、安装</h3> <p>安装最新版本docker-ce</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum install docker-ce -y
#安装指定版本docker-ce可使用以下命令查看
yum list docker-ce.x86_64  --showduplicates | sort -r
# 安装完成之后可以使用命令查看
docker version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="三、配置镜像加速"><a href="#三、配置镜像加速" class="header-anchor">#</a> 三、配置镜像加速</h3> <p>这里使用阿里云的免费镜像加速服务，也可以使用其他如时速云、网易云等</p> <p>1.注册登录开通阿里云<a href="https://cr.console.aliyun.com/cn-hangzhou/repositories" target="_blank" rel="noopener noreferrer">容器镜像服务<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>2.查看控制台，招到镜像加速器并复制自己的加速器地址</p> <p>3.找到/etc/docker目录下的daemon.json文件，没有则直接<code>vi daemon.json</code></p> <p>4.加入以下配置</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#填写自己的加速器地址
{
  &quot;registry-mirrors&quot;: [&quot;https://zfzbet67.mirror.aliyuncs.com&quot;]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>5.通知systemd重载此配置文件；</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl daemon-reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>6.重启docker服务</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl restart docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="docker常用操作"><a href="#docker常用操作" class="header-anchor">#</a> Docker常用操作</h2> <p>输入<code>docker</code>可以查看Docker的命令用法，输入<code>docker COMMAND --help</code>查看指定命令详细用法。</p> <h3 id="镜像常用操作"><a href="#镜像常用操作" class="header-anchor">#</a> 镜像常用操作</h3> <p>查找镜像：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker search 关键词
#搜索docker hub网站镜像的详细信息
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>下载镜像：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker pull 镜像名:TAG
# Tag表示版本，有些镜像的版本显示latest，为最新版本
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>打包镜像</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker save -o redis.tar redis:latest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>加载离线镜像</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker load -i redis.tar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看镜像：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker images
# 查看本地所有镜像
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>删除镜像：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker rmi -f 镜像ID或者镜像名:TAG
# 删除指定本地镜像
# -f 表示强制删除
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>获取元信息：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker inspect 镜像ID或者镜像名:TAG
# 获取镜像的元信息，详细信息
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="容器常用操作"><a href="#容器常用操作" class="header-anchor">#</a> 容器常用操作</h3> <p>​	运行：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run --name 容器名 -i -t -p 主机端口:容器端口 -d -v 主机目录:容器目录:ro 镜像ID或镜像名:TAG
# --name 指定容器名，可自定义，不指定自动命名
# -i 以交互模式运行容器
# -t 分配一个伪终端，即命令行，通常-it组合来使用
# -p 指定映射端口，讲主机端口映射到容器内的端口
# -d 后台运行容器
# -v 指定挂载主机目录到容器目录，默认为rw读写模式，ro表示只读
# -P 如果在不知道容器内应用的具体端口是什么，就可以用它来代替 -p ，会将容器要使用的端口映射到宿主机一个随机的端口上，可以配合docker port 容器名使用
# --privileged=true 让docker容器获取宿主机的root权限


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>容器列表：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker ps -a -q
# docker ps查看正在运行的容器
# -a 查看所有容器（运行中、未运行）
# -q 只查看容器的ID
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>启动容器：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker start 容器ID或容器名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>停止容器：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker stop 容器ID或容器名
docker stop  $(docker  container  ls   -a  -q)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>删除容器：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker rm -f 容器ID或容器名
docker rm  $(docker  container  ls   -a  -q)
# -f 表示强制删除
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>查看日志：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker logs 容器ID或容器名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>进入正在运行容器：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker exec -it 容器ID或者容器名 /bin/bash
# 进入正在运行的容器并且开启交互模式终端
# /bin/bash是固有写法，作用是因为docker后台必须运行一个进程，否则容器就会退出，在这里表示启动容器后启动bash。
# 也可以用docker exec在运行中的容器执行命令
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>拷贝文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker cp 主机文件路径 容器ID或容器名:容器路径 #主机中文件拷贝到容器中
docker cp 容器ID或容器名:容器路径 主机文件路径 #容器中文件拷贝到主机中
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>获取容器元信息：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker inspect 容器ID或容器名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看日志</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker logs 容器ID或容器名
docker logs -f -t --since=&quot;2017-05-31&quot; --tail=10 edu_web_1
--since : 此参数指定了输出日志开始日期，即只输出指定日期之后的日志。
-f : 查看实时日志
-t : 查看日志产生的日期
-tail=10 : 查看最后的10条日志。
edu_web_1 : 容器名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>查看容器暴露的端口</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker port 容器ID或容器名

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>容器中赋予log写入权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chmod 777 xxxxx.log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="docker-安装各种镜像"><a href="#docker-安装各种镜像" class="header-anchor">#</a> Docker 安装各种镜像</h2> <h3 id="mysql"><a href="#mysql" class="header-anchor">#</a> Mysql</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>docker run <span class="token operator">-</span>p <span class="token number">3306</span>:<span class="token number">3306</span> <span class="token comment">--name mysql -v /usr/local/docker-mysql/conf/my.cnf:/etc/mysql/cnf.d -v /usr/local/docker-mysql/logs:/etc/mysql/logs -v /usr/local/docker-mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=admin123 -d mysql:5.6</span>

docker run <span class="token operator">-</span>p <span class="token number">8080</span>:<span class="token number">3306</span> <span class="token comment">--name mysql5.6-2 -v /usr/local/docker-mysql5.6/conf2/my.cnf:/etc/mysql/cnf.d -v /usr/local/docker-mysql5.6/logs2:/etc/mysql/logs -v /usr/local/docker-mysql5.6/data2:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=admin123 -d mysql:5.6</span>


<span class="token comment">-- docker mysql主从架构搭建</span>
<span class="token comment">--/etc/mysql/my.cnf mysql服务端配置文件</span>
<span class="token comment">--/etc/mysql/conf.d/mysql.cnf mysql客户端配置文件</span>

docker run <span class="token operator">-</span>p <span class="token number">3306</span>:<span class="token number">3306</span> <span class="token comment">--name mysql-master -v /usr/local/docker-mysql-master/conf/my.cnf:/etc/mysql/my.cnf -v /usr/local/docker-mysql-master/logs:/etc/mysql/logs -v /usr/local/docker-mysql-master/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=admin123 -d mysql:8.0.20</span>

docker run <span class="token operator">-</span>p <span class="token number">3307</span>:<span class="token number">3306</span> <span class="token comment">--name mysql-slave -v /usr/local/docker-mysql-slave/conf/my.cnf:/etc/mysql/my.cnf -v /usr/local/docker-mysql-slave/logs:/etc/mysql/logs -v /usr/local/docker-mysql-slave/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=admin123 -d mysql:8.0.20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="mongodb"><a href="#mongodb" class="header-anchor">#</a> MongoDB</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run --name mongo -p 27017:27017 -v /usr/local/docker-mongodb/conf:/data/configdb -v /usr/local/docker-mongodb/db/:/data/db/ -v /usr/local/docker-mongodb/mongodb/:/var/log/mongodb/ -d mongo:4.2.8
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="redis"><a href="#redis" class="header-anchor">#</a> redis</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>redis:
docker run --name myredis -p 6379:6379 -v /usr/local/docker-redis/redis.conf:/etc/redis/redis.conf -v /usr/local/docker-redis/data:/data -d redis redis-server /etc/redis/redis.conf --appendonly yes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="oracle"><a href="#oracle" class="header-anchor">#</a> oracle</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>1. 拉取镜像
registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g是一个已经安装好的oracle_11g的镜像
docker pull registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g

2. 运行容器
docker run -d -p 1521:1521 --name oracle11g -v /usr/local/docker-oracle/config/profile:/etc/profile -v /usr/local/docker-oracle/config/.bashrc:/home/oracle/.bashrc registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g

3. 配置oracle
docker exec -it oracle11g bash
su root
分别配置/etc/profile和/home/oracle/.bashrc文件末尾添加环境变量
export ORACLE_HOME=/home/oracle/app/oracle/product/11.2.0/dbhome_2
export ORACLE_SID=helowin
export PATH=$ORACLE_HOME/bin:$PATH

4. 修改sys密码
sqlplus /nolog
conn / as sysdba
alter user sys identified by admin123;

5. 查看oracle数据库实例和状态，此镜像默认实例为:helowin
lsnrctl status 

6. 外部plsql连接测试


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="elasticsearch"><a href="#elasticsearch" class="header-anchor">#</a> Elasticsearch</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>version: '2.2'
services:
  es01:
    image: elasticsearch:7.3.3
    container_name: es01
    environment:
      - node.name=es01
      - cluster.name=es-docker-cluster
      - discovery.seed_hosts=es02,es03
      - cluster.initial_master_nodes=es01,es02,es03
      - bootstrap.memory_lock=true
      - &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;
    ulimits:
      memlock:
        soft: -1
        hard: -1
    ports:
      - 9200:9200
    networks:
      - elastic

  es02:
    image: elasticsearch:7.3.3
    container_name: es02
    environment:
      - node.name=es02
      - cluster.name=es-docker-cluster
      - discovery.seed_hosts=es01,es03
      - cluster.initial_master_nodes=es01,es02,es03
      - bootstrap.memory_lock=true
      - &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;
    ulimits:
      memlock:
        soft: -1
        hard: -1
    ports:
      - 9201:9201
    networks:
      - elastic

  es03:
    image: elasticsearch:7.3.3
    container_name: es03
    environment:
      - node.name=es03
      - cluster.name=es-docker-cluster
      - discovery.seed_hosts=es01,es02
      - cluster.initial_master_nodes=es01,es02,es03
      - bootstrap.memory_lock=true
      - &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;
    ulimits:
      memlock:
        soft: -1
        hard: -1
    ports:
      - 9202:9202
    networks:
      - elastic

  kib01:
    image: kibana:7.3.2
    container_name: kib01
    ports:
      - 5601:5601
    environment:
      ELASTICSEARCH_URL: http://es01:9200
      ELASTICSEARCH_HOSTS: http://es01:9200
    networks:
      - elastic

networks:
  elastic:
    driver: bridge

5.遇到的问题

   5.1. max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]
vm最大虚拟内存,max_map_count[65530]太低，至少增加到[262144]

vim /etc/sysctl.conf
vm.max_map_count=655360
sysctl -p   使配置生效

   5.2. the default discovery settings are unsuitable for production use; at least one of [discovery.seed_hosts, discovery.seed_providers, cluster.initial_master_nodes] must be configured

yml配置文件添加集群引导

   5.3. expecting token of type [START_OBJECT] but found [VALUE_STRING]]; 
yml配置文件语法错误




/usr/share/elasticsearch/plugins

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br></div></div><h3 id="kibana"><a href="#kibana" class="header-anchor">#</a> kibana</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run --name kibana -d -p 5601:5601 -v /usr/local/docker-kibana/config/kibana.yml:/usr/share/kibana/config/kibana.yml --network=es kibana:7.3.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="rabbitmq"><a href="#rabbitmq" class="header-anchor">#</a> rabbitmq</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run -d -p 5672:5672 -p 15672:15672 --name rabbitmq rabbitmq:3.8.3-management
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="nginx"><a href="#nginx" class="header-anchor">#</a> nginx</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run --name nginx -d -p 80:80 -p 443:443 -v /usr/local/docker-nginx/config/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/docker-nginx/html:/usr/share/nginx/html -v /usr/local/docker-nginx/logs/:/var/log/nginx -v /usr/local/docker-nginx/config/server.crt:/etc/nginx/server.crt -v /usr/local/docker-nginx/config/server.key:/etc/nginx/server.key --network=es  lxk/https-nginx:1.0

docker run --name nginx -d -p 80:80 -p 443:443 -v /usr/local/docker-nginx/config/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/docker-nginx/html:/usr/share/nginx/html -v /usr/local/docker-nginx/logs/:/var/log/nginx -v /usr/local/docker-nginx/config/server.crt:/etc/nginx/server.crt -v /usr/local/docker-nginx/config/server.key:/etc/nginx/server.key --network=es  nginx:1.18.0

docker run --name nginx -d -p 80:80 -p 443:443  nginx-https:1.0

docker run --name nginx -d -p 80:80 -p 443:443 -v /usr/local/docker-nginx/config/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/docker-nginx/html:/usr/share/nginx/html -v /usr/local/docker-nginx/logs/:/var/log/nginx -v /usr/local/docker-nginx/config/server.crt:/etc/nginx/server.crt -v /usr/local/docker-nginx/config/server.key:/etc/nginx/server.key --network=es nginx-https:1.0

/usr/sbin/nginx 可执行程序
./nginx -V 查看已安装的模块
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="sqlserver"><a href="#sqlserver" class="header-anchor">#</a> sqlServer</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run -e &quot;ACCEPT_EULA=Y&quot; -e &quot;MSSQL_SA_PASSWORD=SqlServer2019&quot; --name &quot;sql1&quot; -p 1433:1433  -v sql1data:/var/opt/mssql -d mcr.microsoft.com/mssql/server:2019-latest

sqlServer的宿主机挂载似乎只能使用sql1data挂载
实际挂载路径为：/var/lib/docker/volumes/sql1data

docker run -e &quot;ACCEPT_EULA=Y&quot; -e &quot;MSSQL_SA_PASSWORD=SqlServer2019&quot; --name &quot;sql1&quot; -p 1433:1433 -v /usr/local/docker-sql-server/sql1data:/var/opt/mssql -d mcr.microsoft.com/mssql/server:2019-latest
	第一次使用宿主机挂载报错：
		/opt/mssql/bin/sqlservr: Error: The system directory [/.system] could not be created.  Errno [13]
	解决方法：
		chmod 777 /usr/local/docker-sql-server/sql1data
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="docker-遇到的问题"><a href="#docker-遇到的问题" class="header-anchor">#</a> Docker 遇到的问题</h2> <h3 id="tomcat问题"><a href="#tomcat问题" class="header-anchor">#</a> Tomcat问题</h3> <p>安装tomcat镜像，启动容器后，访问tomcat 404 问题</p> <h5 id="具体场景"><a href="#具体场景" class="header-anchor">#</a> 具体场景：</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>用命令: docker exec -it 运行的tomcat容器ID /bin/bash 进入到tomcat的目录

进入webapps文件夹,发现里面是空的(tomcat默认的欢迎页面实际上放在的路径应该是:webapps/ROOT/index.jsp或者index.html)

发现旁边还有个webapps.dist的文件,进入才发现原本应该在webapps文件中的文件都在webapps.dist文件中.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="出现问题的版本"><a href="#出现问题的版本" class="header-anchor">#</a> 出现问题的版本：</h5> <p>​	docker:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Version:           19.03.8
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​	tomcat:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tomcat Tag 8.5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="解决方法"><a href="#解决方法" class="header-anchor">#</a> 解决方法：</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>将webapps.dist重命名成webapps即可,原来的webapps(空文件)可以删除或者命名成其他的名字既:mv webapps.dist webapps

或者修改后提交成新的镜像
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="mysql问题"><a href="#mysql问题" class="header-anchor">#</a> Mysql问题</h3> <h5 id="具体场景-2"><a href="#具体场景-2" class="header-anchor">#</a> 具体场景</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>安装mysql后，创建数据库，关闭容器时，数据没有了
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="解决方法-2"><a href="#解决方法-2" class="header-anchor">#</a> 解决方法</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>
docker run -p 3306:3306 --name mysql -v /usr/local/docker-mysql/conf/my.cnf:/etc/mysql/cnf.d -v /usr/local/docker-mysql/logs:/etc/mysql/logs -v /usr/local/docker-mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=admin123 -d mysql:5.6


-p 端口映射
-v 文件挂载，这里将conf.d配置文件,logs日志以及数据文件挂载到容器中，会覆盖容器指定配置，这样，容器关闭时，data数据就不会清空。






</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>有时候从Docker镜像仓库中下载的镜像不能满足要求，我们可以基于一个基础镜像构建一个自己的镜像</p> <p>两种方式：</p> <ul><li><p>更新镜像：使用<code>docker commit</code>命令</p></li> <li><p>构建镜像：使用<code>docker build</code>命令，需要创建Dockerfile文件</p></li></ul> <h1 id="docker-2"><a href="#docker-2" class="header-anchor">#</a> Docker(2)</h1> <h2 id="更新镜像"><a href="#更新镜像" class="header-anchor">#</a> 更新镜像</h2> <p>先使用基础镜像创建一个容器，然后对容器内容进行更改，然后使用<code>docker commit</code>命令提交为一个新的镜像（以tomcat为例）。</p> <p>1.根据基础镜像，创建容器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run --name mytomcat -p 80:8080 -d tomcat
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2.修改容器内容</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker exec -it mytomcat /bin/bash
cd webapps/ROOT
rm -f index.jsp
echo hello world &gt; index.html
exit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>3.提交为新镜像</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker commit -m=&quot;描述消息&quot; -a=&quot;作者&quot; 容器ID或容器名 镜像名:TAG
# 例:
# docker commit -m=&quot;修改了首页&quot; -a=&quot;华安&quot; mytomcat huaan/tomcat:v1.0
docker commit -m=&quot;nginx-https&quot; -a=&quot;lxk&quot; nginx nginx-https:1.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>注意：commit虽然可以更新为最新的镜像，但是是有限制的，只能更新在容器中修改的东西，例如在容器中复制一个文件，但是通过-v命令挂载的东西，是不会更新的</strong></p> <p>4.使用新镜像运行容器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run --name tom -p 8080:8080 -d huaan/tomcat:v1.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>注意：使用commit提交的方式生成的新镜像，镜像只会更新在容器内部修改的东西，例如cp进去一个文件，添加一个目录，但是使用-v命令挂载的文件里面的内容并不会被修改，例如容器内有个配置文件，port=80，启动容器时-v挂载，port=81，commit后port=80</strong></p> <h2 id="使用dockerfile构建镜像"><a href="#使用dockerfile构建镜像" class="header-anchor">#</a> 使用Dockerfile构建镜像</h2> <h3 id="什么是dockerfile"><a href="#什么是dockerfile" class="header-anchor">#</a> 什么是Dockerfile？</h3> <p>Dockerfile is nothing but the source code for building Docker images</p> <ul><li><p>Docker can build images automatically by reading the instructions from a Dockerfile</p></li> <li><p>A Dockerfile is a <strong>text document</strong> that contains all the commands a user could call on the command line to assemble an image</p></li> <li><ul><li>Using <strong>docker build</strong> users can create an automated build that executes several command-line instructions in succession</li></ul></li></ul> <p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/365147/1587017706307-8195b999-d90b-467a-a24f-15969ee89493.jpeg" alt="dockerfile.jpg"></p> <h3 id="dockerfile格式"><a href="#dockerfile格式" class="header-anchor">#</a> Dockerfile格式</h3> <ul><li><p>Format：</p></li> <li><ul><li>#Comment</li></ul></li> <li><ul><li>INSTRUCTION arguments</li></ul></li> <li><p>The instruction is not case-sensitive</p></li> <li><ul><li>However,convention is for them to be UPPERCASE to distinguish them from arguments more easily</li></ul></li> <li><p>Docker runs instructions in a Dockerfile in order</p></li> <li><p>The first instruction must be 'FROM' in order to specify the Base Image from which you are building</p></li></ul> <h3 id="使用dockerfile构建springboot应用镜像"><a href="#使用dockerfile构建springboot应用镜像" class="header-anchor">#</a> 使用Dockerfile构建SpringBoot应用镜像</h3> <p>一、准备</p> <p>1.把你的springboot项目打包成可执行jar包</p> <p>2.把jar包上传到Linux服务器</p> <p>二、构建</p> <p>1.在jar包路径下创建Dockerfile文件<code>vi Dockerfile</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 指定基础镜像，本地没有会从dockerHub pull下来
FROM java:8
#作者
MAINTAINER huaan
# 把可执行jar包复制到基础镜像的根目录下
# 可以添加多个ADD或COPY
ADD luban.jar /luban.jar
# 镜像要暴露的端口，如要使用端口，在执行docker run命令时使用-p生效
EXPOSE 80
# 在镜像运行为容器后执行的命令
ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/luban.jar&quot;]


#指定基础镜像，本地没有会从dockerHub pull下来
FROM java:8
#作者
MAINTAINER lxk
# 把可执行jar包复制到基础镜像的根目录下
# 可以添加多个ADD或COPY
ADD mycat /mycat
# 镜像要暴露的端口，如要使用端口，在执行docker run命令时使用-p生效
EXPOSE 5044
# 在镜像运行为容器后执行的命令
CMD /mycat/bin/mycat console

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>2.使用<code>docker build</code>命令构建镜像，基本语法</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker build -t springbootdemo:0.1 .
# -f指定Dockerfile文件的路径
# -t指定镜像名字和TAG
# .指当前目录，这里实际上需要一个上下文路径
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>三、运行</p> <p>运行自己的SpringBoot镜像</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run --name pro -p 80:80 -d 镜像名:TAG
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="dockerfile常用指令"><a href="#dockerfile常用指令" class="header-anchor">#</a> Dockerfile常用指令</h3> <h4 id="from"><a href="#from" class="header-anchor">#</a> FROM</h4> <p>FROM指令是最重要的一个并且必须为Dockerfile文件开篇的第一个非注释行，用于为镜像文件构建过程指定基础镜像，后续的指令运行于此基础镜像提供的运行环境</p> <p>这个基础镜像可以是任何可用镜像，默认情况下docker build会从本地仓库找指定的镜像文件，如果不存在就会从Docker Hub上拉取</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>FROM &lt;image&gt;
FROM &lt;image&gt;:&lt;tag&gt;
FROM &lt;image&gt;@&lt;digest&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="maintainer-depreacted"><a href="#maintainer-depreacted" class="header-anchor">#</a> MAINTAINER(depreacted)</h4> <p>Dockerfile的制作者提供的本人详细信息</p> <p>Dockerfile不限制MAINTAINER出现的位置，但是推荐放到FROM指令之后</p> <p>语法：</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>MAINTAINER &lt;name&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>name可以是任何文本信息，一般用作者名称或者邮箱</p> <h4 id="label"><a href="#label" class="header-anchor">#</a> LABEL</h4> <p>给镜像指定各种元数据</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>LABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt;...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>一个Dockerfile可以写多个LABEL，但是不推荐这么做，Dockerfile每一条指令都会生成一层镜像，如果LABEL太长可以使用\符号换行。构建的镜像会继承基础镜像的LABEL，并且会去掉重复的，但如果值不同，则后面的值会覆盖前面的值。</p> <h4 id="copy"><a href="#copy" class="header-anchor">#</a> COPY</h4> <p>用于从宿主机复制文件到创建的新镜像文件</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>COPY &lt;src&gt;...&lt;dest&gt;
COPY [&quot;&lt;src&gt;&quot;,...&quot;&lt;dest&gt;&quot;]
# &lt;src&gt;：要复制的源文件或者目录，可以使用通配符
# &lt;dest&gt;：目标路径，即正在创建的image的文件系统路径；建议&lt;dest&gt;使用绝对路径，否则COPY指令则以WORKDIR为其起始路径
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>注意：如果你的路径中有空白字符，通常会使用第二种格式</p> <p>规则：</p> <ul><li><p>``必须是build上下文中的路径，不能是其父目录中的文件</p></li> <li><p>如果<code>是目录，则其内部文件或子目录会被递归复制，但</code>目录自身不会被复制</p></li> <li><p>如果指定了多个<code>，或在</code>中使用了通配符，则``必须是一个目录，则必须以/符号结尾</p></li> <li><p>如果``不存在，将会被自动创建，包括其父目录路径</p></li></ul> <h4 id="add"><a href="#add" class="header-anchor">#</a> ADD</h4> <p>基本用法和COPY指令一样，ADD支持使用TAR文件和URL路径</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ADD &lt;src&gt;...&lt;dest&gt;
ADD [&quot;&lt;src&gt;&quot;,...&quot;&lt;dest&gt;&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>规则：</p> <ul><li><p>和COPY规则相同</p></li> <li><p>如果<code>为URL并且</code>没有以/结尾，则<code>指定的文件将被下载到</code></p></li> <li><p>如果``是一个本地系统上压缩格式的tar文件，它会展开成一个目录；但是通过URL获取的tar文件不会自动展开</p></li> <li><p>如果<code>有多个，直接或间接使用了通配符指定多个资源，则</code>必须是目录并且以/结尾</p></li></ul> <h4 id="workdir"><a href="#workdir" class="header-anchor">#</a> WORKDIR</h4> <p>用于为Dockerfile中所有的RUN、CMD、ENTRYPOINT、COPY和ADD指定设定工作目录，只会影响当前WORKDIR之后的指令。</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>WORKDIR &lt;dirpath&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在Dockerfile文件中，WORKDIR可以出现多次，路径可以是相对路径，但是它是相对于前一个WORKDIR指令指定的路径</p> <p>另外，WORKDIR可以是ENV指定定义的变量</p> <h4 id="volume"><a href="#volume" class="header-anchor">#</a> VOLUME</h4> <p>用来创建挂载点，可以挂载宿主机上的卷或者其他容器上的卷</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>VOLUME &lt;mountpoint&gt;
VOLUME [&quot;&lt;mountpoint&gt;&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>不能指定宿主机当中的目录，宿主机挂载的目录是自动生成的</p> <h4 id="expose"><a href="#expose" class="header-anchor">#</a> EXPOSE</h4> <p>用于给容器打开指定要监听的端口以实现和外部通信</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>EXPOSE &lt;port&gt;[/&lt;protocol&gt;] [&lt;port&gt;[/&lt;protocol&gt;]...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>``用于指定传输层协议，可以是TCP或者UDP，默认是TCP协议</p> <p>EXPOSE可以一次性指定多个端口，例如：<code>EXPOSE 80/tcp 80/udp</code></p> <h4 id="env"><a href="#env" class="header-anchor">#</a> ENV</h4> <p>用来给镜像定义所需要的环境变量，并且可以被Dockerfile文件中位于其后的其他指令(如ENV、ADD、COPY等)所调用，调用格式：<img src="https://g.yuque.com/gr/latex?variable_name%E6%88%96%E8%80%85" alt="img">{variable_name}</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ENV &lt;key&gt; &lt;value&gt;
ENV &lt;key&gt;=&lt;value&gt;...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>第一种格式中，<code>之后的所有内容都会被视为</code>的组成部分，所以一次只能设置一个变量</p> <p>第二种格式可以一次设置多个变量，如果<code>当中有空格可以使用\进行转义或者对</code>加引号进行标识；另外\也可以用来续行</p> <h4 id="arg"><a href="#arg" class="header-anchor">#</a> ARG</h4> <p>用法同ENV</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ARG &lt;name&gt;[=&lt;default value&gt;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>指定一个变量，可以在docker build创建镜像的时候，使用<code>--build-arg =</code>来指定参数</p> <h4 id="run"><a href="#run" class="header-anchor">#</a> RUN</h4> <p>用来指定docker build过程中运行指定的命令</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>RUN &lt;command&gt;
RUN [&quot;&lt;executable&gt;&quot;,&quot;&lt;param1&gt;&quot;,&quot;&lt;param2&gt;&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>第一种格式里面的参数一般是一个shell命令，以<code>/bin/sh -c</code>来运行它</p> <p>第二种格式中的参数是一个JSON格式的数组，当中``是要运行的命令，后面是传递给命令的选项或者参数；但是这种格式不会用<code>/bin/sh -c</code>来发起，所以常见的shell操作像变量替换和通配符替换不会进行；如果你运行的命令依赖shell特性，可以替换成类型以下的格式</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>RUN [&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;&lt;executable&gt;&quot;,&quot;&lt;param1&gt;&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="cmd"><a href="#cmd" class="header-anchor">#</a> CMD</h4> <p>容器启动时运行的命令</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>CMD &lt;command&gt;
CMD [&quot;&lt;executable&gt;&quot;,&quot;&lt;param1&gt;&quot;,&quot;&lt;param2&gt;&quot;]
CMD [&quot;&lt;param1&gt;&quot;,&quot;&lt;param2&gt;&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>前两种语法和RUN相同</p> <p>第三种语法用于为ENTRYPOINT指令提供默认参数</p> <p>RUN和CMD区别：</p> <ul><li><p>RUN指令运行于镜像文件构建过程中，CMD则运行于基于Dockerfile构建出的新镜像文件启动为一个容器的时候</p></li> <li><p>CMD指令的主要目的在于给启动的容器指定默认要运行的程序，且在运行结束后，容器也将终止；不过，CMD命令可以被docker run的命令行选项给覆盖</p></li> <li><p>Dockerfile中可以存在多个CMD指令，但是只有最后一个会生效</p></li></ul> <h4 id="entrypoint"><a href="#entrypoint" class="header-anchor">#</a> ENTRYPOINT</h4> <p>类似于CMD指令功能，用于给容器指定默认运行程序</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ENTRYPOINT&lt;command&gt;
ENTRYPOINT[&quot;&lt;executable&gt;&quot;,&quot;&lt;param1&gt;&quot;,&quot;&lt;param2&gt;&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>和CMD不同的是ENTRYPOINT启动的程序不会被docker run命令指定的参数所覆盖，而且，这些命令行参数会被当做参数传递给ENTRYPOINT指定的程序(但是，docker run命令的--entrypoint参数可以覆盖ENTRYPOINT)</p> <p>docker run命令传入的参数会覆盖CMD指令的内容并且附加到ENTRYPOINT命令最后作为其参数使用</p> <p>同样，Dockerfile中可以存在多个ENTRYPOINT指令，但是只有最后一个会生效</p> <p>Dockerfile中如果既有CMD又有ENTRYPOINT，并且CMD是一个完整可执行命令，那么谁在最后谁生效</p> <h4 id="onbuild"><a href="#onbuild" class="header-anchor">#</a> ONBUILD</h4> <p>用来在Dockerfile中定义一个触发器</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ONBUILD &lt;instruction&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Dockerfile用来构建镜像文件，镜像文件也可以当成是基础镜像被另外一个Dockerfile用作FROM指令的参数</p> <p>在后面这个Dockerfile中的FROM指令在构建过程中被执行的时候，会触发基础镜像里面的ONBUILD指令</p> <p>ONBUILD不能自我嵌套，ONBUILD不会触发FROM和MAINTAINER指令</p> <p>在ONBUILD指令中使用ADD和COPY要小心，因为新构建过程中的上下文在缺少指定的源文件的时候会失败</p> <p>有时候需要共享镜像或者习惯使用自己定义的镜像，可以注册私有仓库，国内推荐使用阿里云</p> <p>步骤：</p> <p>1.登录阿里云容器镜像服务：https://cr.console.aliyun.com/cn-hangzhou/repositories</p> <p>2.将镜像推送到阿里云</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 登录阿里云的docker仓库
$ sudo docker login --username=[用户名] registry.cn-hangzhou.aliyuncs.com
# 创建指定镜像的tag，归入某个仓库
$ sudo docker tag [镜像ID] registry.cn-hangzhou.aliyuncs.com/huaan/huaan:[镜像版本号]
# 讲镜像推送到仓库
$ sudo docker push registry.cn-hangzhou.aliyuncs.com/huaan/huaan:[镜像版本号]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>3.拉取镜像</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker pull registry.cn-hangzhou.aliyuncs.com/coldest7/mytom:v1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="docker-网络"><a href="#docker-网络" class="header-anchor">#</a> Docker 网络</h1> <p>Docker允许通过外部访问容器或容器互联的方式来提供网络服务。</p> <p>安装Docker时，会自动安装一块Docker网卡称为docker0，用于Docker各容器及宿主机的网络通信，网段为172.0.0.1。</p> <p>Docker网络中有三个核心概念：沙盒（Sandbox）、网络（Network）、端点（Endpoint）。</p> <ul><li><p>沙盒，提供了容器的虚拟网络栈，也即端口套接字、IP路由表、防火墙等内容。隔离容器网络与宿主机网络，形成了完全独立的容器网络环境。</p></li> <li><p>网络，可以理解为Docker内部的虚拟子网，网络内的参与者相互可见并能够进行通讯。Docker的虚拟网络和宿主机网络是存在隔离关系的，其目的主要是形成容器间的安全通讯环境。</p></li> <li><p>端点，位于容器或网络隔离墙之上的洞，主要目的是形成一个可以控制的突破封闭的网络环境的出入口。当容器的端点与网络的端点形成配对后，就如同在这两者之间搭建了桥梁，便能够进行数据传输了。</p></li></ul> <h2 id="docker的四种网络模式"><a href="#docker的四种网络模式" class="header-anchor">#</a> Docker的四种网络模式</h2> <p>Docker服务在启动的时候会创建三种网络，bridge、host和none，还有一种共享容器的模式container</p> <h3 id="bridge"><a href="#bridge" class="header-anchor">#</a> Bridge</h3> <p>桥接模式，主要用来对外通信的，docker容器默认的网络使用的就是bridge。</p> <p>使用bridge模式配置容器自定的网络配置</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 配置容器的主机名
docker run --name t1 --network bridge -h [自定义主机名] -it --rm busybox
# 自定义DNS
docker run --name t1 --network bridge --dns 114.114 -it --rm busybox
# 给host文件添加一条
docker run --name t1 --network bridge --add-host [hostname]:[ip] -it --rm busybox
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>默认网络与自定义bridge网络的区别</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1. 默认的桥接网络容器之间通讯只能通过ip地址的方式通讯，而自定义的网络提供DNS解析，可以直接通过容器名访问其他容器
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="host"><a href="#host" class="header-anchor">#</a> Host</h3> <p>host类型的网络就是主机网络的意思，绑定到这种网络上面的容器，内部使用的端口直接绑定在主机上对应的端口，而如果容器服务没有使用端口，则无影响。</p> <h3 id="none"><a href="#none" class="header-anchor">#</a> None</h3> <p>从某种意义上来说，none应该算不上网络了，因为它不使用任何网络，会形成一个封闭网络的容器</p> <h3 id="container"><a href="#container" class="header-anchor">#</a> container</h3> <p>共享另外一个容器的network namespace，和host模式差不多，只是这里不是使用宿主机网络，而是使用的容器网络</p> <h2 id="自定义docker0桥的网络属性信息"><a href="#自定义docker0桥的网络属性信息" class="header-anchor">#</a> 自定义docker0桥的网络属性信息</h2> <p>/etc/docker/daemon.json文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
&quot;bip&quot;: &quot;192.168.5.5/16&quot;,
&quot;fixed-cidr&quot;: &quot;10.20.0.0/16&quot;,
&quot;fixed-cidr-v6&quot;: &quot;2001:db8::/64&quot;,
&quot;mtu&quot;: 1500,
&quot;default-gateway&quot;: &quot;10.20.1.1&quot;,
&quot;default-gateway-v6&quot;: &quot;2001:db8:abcd::89&quot;,
&quot;dns&quot;: [&quot;10.20.1.2&quot;,&quot;10.20.1.3&quot;]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>核心选项为bip，即bridge ip之意，用于指定docker0桥自身的IP地址；其它选项可通过此地址计算得出</p> <p>创建自定义的桥网络</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker network create -d bridge --subnet &quot;172.26.0.0/16&quot; --gateway &quot;172.26.0.1&quot; mybr0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="docker-compose"><a href="#docker-compose" class="header-anchor">#</a> Docker Compose</h1> <p>从上一节课我们了解到可以使用一个Dockerfile模板文件来快速构建一个自己的镜像并运行为应用容器。但是在平时工作的时候，我们会碰到多个容器要互相配合来使用的情况，比如数据库加上咱们Web应用等等。这种情况下，每次都要一个一个启动容器设置命令变得麻烦起来，所以Docker Compose诞生了。</p> <h2 id="简介-2"><a href="#简介-2" class="header-anchor">#</a> 简介</h2> <p>Compose的作用是“定义和运行多个Docker容器的应用”。使用Compose，你可以在一个配置文件（yaml格式）中配置你应用的服务，然后使用一个命令，即可创建并启动配置中引用的所有服务。</p> <p>Compose中两个重要概念：</p> <ul><li><p>服务 (service)：一个应用的容器，实际上可以包括若干运行相同镜像的容器实例。</p></li> <li><p>项目 (project)：由一组关联的应用容器组成的一个完整业务单元，在 docker-compose.yml文件中定义。</p></li></ul> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <p>Compose支持三平台Windows、Mac、Linux，安装方式各有不同。我这里使用的是Linux系统，其他系统安装方法可以参考官方文档和开源GitHub链接：</p> <p>Docker Compose官方文档链接：https://docs.docker.com/compose</p> <p>Docker Compose GitHub链接：https://github.com/docker/compose</p> <p>Linux上有两种安装方法，Compose项目是用Python写的，可以使用Python-pip安装，也可以通过GitHub下载二进制文件进行安装。</p> <h3 id="通过python-pip安装"><a href="#通过python-pip安装" class="header-anchor">#</a> 通过Python-pip安装</h3> <p>1.安装Python-pip</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum install -y epel-release
yum install -y python-pip
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>2.安装docker-compose</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>pip install docker-compose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.验证是否安装</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker-compose version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4.卸载</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>pip uninstall docker-compose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="通过github链接下载安装"><a href="#通过github链接下载安装" class="header-anchor">#</a> 通过GitHub链接下载安装</h3> <p>非ROOT用户记得加sudo</p> <p>1.通过GitHub获取下载链接，以往版本地址：https://github.com/docker/compose/releases</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl -L &quot;https://github.com/docker/compose/releases/download/1.23.2/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2.给二进制下载文件可执行的权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chmod +x /usr/local/bin/docker-compose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.可能没有启动程序，设置软连接，比如:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4.验证是否安装</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker-compose version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>5.卸载</p> <p>如果是二进制包方式安装的，删除二进制文件即可。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>rm /usr/local/bin/docker-compose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="简单实例"><a href="#简单实例" class="header-anchor">#</a> 简单实例</h3> <p>Compose的使用非常简单，只需要编写一个docker-compose.yml，然后使用docker-compose 命令操作即可。docker-compose.yml描述了容器的配置，而docker-compose 命令描述了对容器的操作。</p> <p>1.我们使用一个微服务项目先来做一个简单的例子，首先创建一个compose的工作目录，然后创建一个eureka文件夹，里面放可执行jar包和编写一个Dockerfile文件，目录结构如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>compose
    eureka
        Dockerfile
        eureka-server-2.0.2.RELEASE.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>2.在compose目录创建模板文件docker-compose.yml文件并写入以下内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>version: '1'
services:
  eureka:
    build: ./eureka
    ports:
     - 3000:3000
    expose:
     - 3000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="docker-compose模板文件常用指令"><a href="#docker-compose模板文件常用指令" class="header-anchor">#</a> Docker Compose模板文件常用指令</h2> <h3 id="image"><a href="#image" class="header-anchor">#</a> image</h3> <p>指定镜像名称或者镜像id，如果该镜像在本地不存在，Compose会尝试pull下来。</p> <p>示例：</p> <p>image: java:8</p> <h3 id="build"><a href="#build" class="header-anchor">#</a> build</h3> <p>指定Dockerfile文件的路径。可以是一个路径，例如：</p> <p>build: ./dir</p> <p>也可以是一个对象，用以指定Dockerfile和参数，例如：</p> <p>build:  context: ./dir  dockerfile: Dockerfile-alternate  args:   buildno: 1</p> <h3 id="command"><a href="#command" class="header-anchor">#</a> command</h3> <p>覆盖容器启动后默认执行的命令。</p> <p>示例：</p> <p>command: bundle exec thin -p 3000</p> <p>也可以是一个list，类似于Dockerfile总的CMD指令，格式如下：</p> <p>command: [bundle, exec, thin, -p, 3000]</p> <h3 id="links"><a href="#links" class="header-anchor">#</a> links</h3> <p>容器间通信使用，链接到其他服务中的容器。可以指定服务名称和链接的别名使用SERVICE:ALIAS 的形式，或者只指定服务名称，示例：</p> <p>web:  links:   - db   - db:database   - redis</p> <h3 id="external-links"><a href="#external-links" class="header-anchor">#</a> external_links</h3> <p>表示链接到docker-compose.yml外部的容器，甚至并非Compose管理的容器，特别是对于那些提供共享容器或共同服务。格式跟links类似，示例：</p> <p>external_links:  - redis_1  - project_db_1:mysql  - project_db_1:postgresql</p> <h3 id="ports"><a href="#ports" class="header-anchor">#</a> ports</h3> <p>暴露端口信息。使用宿主端口:容器端口的格式，或者仅仅指定容器的端口（此时宿主机将会随机指定端口），类似于docker run -p ，示例：</p> <p>ports:</p> <ul><li><p>&quot;3000&quot;</p></li> <li><p>&quot;3000-3005&quot;</p></li> <li><p>&quot;8000:8000&quot;</p></li> <li><p>&quot;9090-9091:8080-8081&quot;</p></li> <li><p>&quot;49100:22&quot;</p></li> <li><p>&quot;127.0.0.1:8001:8001&quot;</p></li> <li><p>&quot;127.0.0.1:5000-5010:5000-5010&quot;</p></li></ul> <h3 id="expose-2"><a href="#expose-2" class="header-anchor">#</a> expose</h3> <p>暴露端口，只将端口暴露给连接的服务，而不暴露给宿主机，示例：</p> <p>expose:  - &quot;3000&quot;  - &quot;8000&quot;</p> <h3 id="volumes"><a href="#volumes" class="header-anchor">#</a> volumes</h3> <p>卷挂载路径设置。可以设置宿主机路径 （HOST:CONTAINER） 或加上访问模式 （HOST:CONTAINER:ro）。示例：</p> <p>volumes:</p> <p>Just specify a path and let the Engine create a volume</p> <ul><li>/var/lib/mysql</li></ul> <p>Specify an absolute path mapping</p> <ul><li>/opt/data:/var/lib/mysql</li></ul> <p>Path on the host, relative to the Compose file</p> <ul><li>./cache:/tmp/cache</li></ul> <p>User-relative path</p> <ul><li>~/configs:/etc/configs/:ro</li></ul> <p>Named volume</p> <ul><li>datavolume:/var/lib/mysql</li></ul> <h3 id="volumes-from"><a href="#volumes-from" class="header-anchor">#</a> volumes_from</h3> <p>从另一个服务或者容器挂载卷。可以指定只读或者可读写，如果访问模式没有指定，则默认是可读写。示例：</p> <p>volumes_from:</p> <ul><li><p>service_name</p></li> <li><p>service_name:ro</p></li> <li><p>container:container_name</p></li> <li><p>container:container_name:rw</p></li></ul> <h3 id="environment"><a href="#environment" class="header-anchor">#</a> environment</h3> <p>设置环境变量。可以使用数组或者字典两种方式。只有一个key的环境变量可以在运行Compose的机器上找到对应的值，这有助于加密的或者特殊主机的值。示例：</p> <p>environment:  RACK_ENV: development  SHOW: 'true'  SESSION_SECRET:  environment:  - RACK_ENV=development  - SHOW=true  - SESSION_SECRET</p> <h3 id="env-file"><a href="#env-file" class="header-anchor">#</a> env_file</h3> <p>从文件中获取环境变量，可以为单独的文件路径或列表。如果通过 docker-compose -f FILE 指定了模板文件，则 env_file 中路径会基于模板文件路径。如果有变量名称与 environment 指令冲突，则以envirment 为准。示例：</p> <p>env_file: .env  env_file:  - ./common.env  - ./apps/web.env  - /opt/secrets.env</p> <h3 id="extends"><a href="#extends" class="header-anchor">#</a> extends</h3> <p>继承另一个服务，基于已有的服务进行扩展。</p> <h3 id="net"><a href="#net" class="header-anchor">#</a> net</h3> <p>设置网络模式。示例：</p> <p>net: &quot;bridge&quot; net: &quot;host&quot; net: &quot;none&quot; net: &quot;container:[service name or container name/id]&quot;</p> <h3 id="dns"><a href="#dns" class="header-anchor">#</a> dns</h3> <p>配置dns服务器。可以是一个值，也可以是一个列表。示例：</p> <p>dns: 8.8.8.8 dns:  - 8.8.8.8  - 9.9.9.9</p> <h3 id="dns-search"><a href="#dns-search" class="header-anchor">#</a> dns_search</h3> <p>配置DNS的搜索域，可以是一个值，也可以是一个列表，示例：</p> <p>dns_search: example.com dns_search:  - dc1.example.com  - dc2.example.com</p> <h3 id="其它"><a href="#其它" class="header-anchor">#</a> 其它</h3> <p>docker-compose.yml 还有很多其他命令，可以参考docker-compose.yml文件官方文档：</p> <p>https://docs.docker.com/compose/compose-file/</p> <h2 id="使用docker-compose编排springcloud微服务"><a href="#使用docker-compose编排springcloud微服务" class="header-anchor">#</a> 使用Docker Compose编排SpringCloud微服务</h2> <p>使用docker-compose一次性来编排三个微服务:eureka服务(eureka-server-2.0.2.RELEASE.jar)、user服务(user-2.0.2.RELEASE.jar)、power服务(power-2.0.2.RELEASE.jar)</p> <p>1.创建一个工作目录和docker-compose模板文件</p> <p>2.工作目录下创建三个文件夹eureka、user、power，并分别构建好三个服务的镜像文件</p> <p>以eureka的Dockerfile为例:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 基础镜像
FROM java:8
# 作者
MAINTAINER huaan
# 把可执行jar包复制到基础镜像的根目录下
ADD eureka-server-2.0.2.RELEASE.jar /eureka-server-2.0.2.RELEASE.jar
# 镜像要暴露的端口，如要使用端口，在执行docker run命令时使用-p生效
EXPOSE 8080
# 在镜像运行为容器后执行的命令
ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/eureka-server-2.0.2.RELEASE.jar&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>目录文件结构：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>compose
    docker-compose.yml
    eureka
        Dockerfile
        eureka-server-2.0.2.RELEASE.jar
    user
        Dockerfile
        user-2.0.2.RELEASE.jar
    power
        Dockerfile
        power-2.0.2.RELEASE.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>3.编写docker-compose模板文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>version: '3.3'
services:
  eureka:
    image: eureka:v1
    ports:
     - 8080:8080
  user:
    image: user:v1
    ports:
     - 8081:8081
  power:
    image: power:v1
    ports:
     - 8082:8082
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>4.启动微服务，可以加上参数-d后台启动</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker-compose up -d
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/luxiaokaiEx/blog/edit/main/docs/_posts/随笔/Docker.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/05/24, 07:01:30</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/blog/pages/114fc4/"><div>
            Sentinel
            <!----></div></a> <span class="date">05-24</span></dt></dl><dl><dd>02</dd> <dt><a href="/blog/pages/0e51e2/"><div>
            Elasticsearch基本概念
            <!----></div></a> <span class="date">05-24</span></dt></dl><dl><dd>03</dd> <dt><a href="/blog/pages/3fbb76/"><div>
            Redis
            <!----></div></a> <span class="date">05-24</span></dt></dl> <dl><dd></dd> <dt><a href="/blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:894072666@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/luxiaokai" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2022
    <span>Evan Xu | <a href="https://github.com/luxiaokai/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/blog/assets/js/app.b5a3e498.js" defer></script><script src="/blog/assets/js/2.54247e65.js" defer></script><script src="/blog/assets/js/82.8aea023f.js" defer></script>
  </body>
</html>
